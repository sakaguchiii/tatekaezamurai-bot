# ğŸ”§ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**ã‚¨ãƒ©ãƒ¼**: `Error: unable to open database "dist/data/database.db": unable to open database file`

**ç™ºç”Ÿæ—¥**: 2026å¹´1æœˆ25æ—¥

---

## ğŸ” åŸå› ã®å¯èƒ½æ€§

### 1. ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒé•ã† â­â­â­â­â­

**æœ€ã‚‚å¯èƒ½æ€§ãŒé«˜ã„**

SQLiteã¯**ç›¸å¯¾ãƒ‘ã‚¹**ã§æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å®Ÿè¡Œã—ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚ˆã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ãŒå¤‰ã‚ã‚Šã¾ã™ã€‚

**ä¾‹**:
```bash
# serverãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹å ´åˆ
/home/sk283/tatekaezamurai-bot/server $ sqlite3 dist/data/database.db
â†’ /home/sk283/tatekaezamurai-bot/server/dist/data/database.db ã‚’æ¢ã™ âœ…

# è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹å ´åˆ
/home/sk283/tatekaezamurai-bot $ sqlite3 dist/data/database.db
â†’ /home/sk283/tatekaezamurai-bot/dist/data/database.db ã‚’æ¢ã™ âŒï¼ˆå­˜åœ¨ã—ãªã„ï¼‰

# ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ã‚‹å ´åˆ
/home/sk283 $ sqlite3 dist/data/database.db
â†’ /home/sk283/dist/data/database.db ã‚’æ¢ã™ âŒï¼ˆå­˜åœ¨ã—ãªã„ï¼‰
```

**è§£æ±ºæ–¹æ³•**:

```bash
# ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèª
pwd

# serverãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd ~/tatekaezamurai-bot/server

# SQLiteã‚’å®Ÿè¡Œ
sqlite3 dist/data/database.db
```

---

### 2. ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ â­â­â­â­

**ç¢ºèªæ–¹æ³•**:

```bash
# serverãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd ~/tatekaezamurai-bot/server

# ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -lh dist/data/database.db

# å‡ºåŠ›ä¾‹ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰
-rw-r--r-- 1 sk283 sk283 20K 1æœˆ 25 10:00 dist/data/database.db

# å‡ºåŠ›ä¾‹ï¼ˆå­˜åœ¨ã—ãªã„å ´åˆï¼‰
ls: cannot access 'dist/data/database.db': No such file or directory
```

**ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã®åŸå› **:

1. **ãƒ“ãƒ«ãƒ‰ã—ã¦ã„ãªã„**
   - `npm run build` ã‚’å®Ÿè¡Œã—ã¦ã„ãªã„
   - `dist/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¦ã„ãªã„

2. **åˆå›èµ·å‹•ã—ã¦ã„ãªã„**
   - ã‚µãƒ¼ãƒãƒ¼ãŒä¸€åº¦ã‚‚èµ·å‹•ã—ã¦ã„ãªã„
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒè‡ªå‹•ä½œæˆã•ã‚Œã¦ã„ãªã„

3. **å‰Šé™¤ã•ã‚ŒãŸ**
   - èª¤ã£ã¦å‰Šé™¤ã•ã‚ŒãŸ
   - ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¶ˆã•ã‚ŒãŸ

**è§£æ±ºæ–¹æ³•**:

```bash
# ãƒ“ãƒ«ãƒ‰
cd ~/tatekaezamurai-bot/server
npm run build

# ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒè‡ªå‹•ä½œæˆã•ã‚Œã‚‹ï¼‰
pm2 restart all

# ç¢ºèª
ls -lh dist/data/database.db
```

---

### 3. æ¨©é™ãŒãªã„ â­â­

**ç¢ºèªæ–¹æ³•**:

```bash
# ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™ã‚’ç¢ºèª
ls -l dist/data/database.db

# å‡ºåŠ›ä¾‹
-rw-r--r-- 1 root root 20K 1æœˆ 25 10:00 dist/data/database.db
          â†‘ æ‰€æœ‰è€…ãŒrootã®å ´åˆã€ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ›¸ãè¾¼ã‚ãªã„

# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ã‚‚ç¢ºèª
ls -ld dist/data/

# å‡ºåŠ›ä¾‹
drwxr-xr-x 2 sk283 sk283 4.0K 1æœˆ 25 10:00 dist/data/
```

**è§£æ±ºæ–¹æ³•**:

```bash
# æ‰€æœ‰è€…ã‚’å¤‰æ›´ï¼ˆå¿…è¦ãªå ´åˆï¼‰
sudo chown -R sk283:sk283 dist/data/

# æ¨©é™ã‚’ä»˜ä¸
chmod 644 dist/data/database.db
```

---

### 4. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„ â­â­â­

`dist/data/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªè‡ªä½“ãŒå­˜åœ¨ã—ãªã„ã€‚

**ç¢ºèªæ–¹æ³•**:

```bash
ls -la dist/
```

**è§£æ±ºæ–¹æ³•**:

```bash
# ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ
mkdir -p dist/data

# ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒè‡ªå‹•ä½œæˆã•ã‚Œã‚‹ï¼‰
pm2 restart all
```

---

### 5. ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹ â­â­â­

çµ¶å¯¾ãƒ‘ã‚¹ã¨ç›¸å¯¾ãƒ‘ã‚¹ã‚’æ··åŒã—ã¦ã„ã‚‹ã€‚

**æ­£ã—ã„ãƒ‘ã‚¹ä¾‹**:

```bash
# ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆserverãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ï¼‰
sqlite3 dist/data/database.db

# çµ¶å¯¾ãƒ‘ã‚¹ï¼ˆã©ã“ã‹ã‚‰ã§ã‚‚OKï¼‰
sqlite3 /home/sk283/tatekaezamurai-bot/server/dist/data/database.db

# çµ¶å¯¾ãƒ‘ã‚¹ï¼ˆ~ã‚’ä½¿ç”¨ï¼‰
sqlite3 ~/tatekaezamurai-bot/server/dist/data/database.db
```

---

## ğŸ” è¨ºæ–­æ‰‹é †

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’é †ç•ªã«å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

### Step 1: ç¾åœ¨åœ°ã‚’ç¢ºèª

```bash
pwd
# å‡ºåŠ›: /home/sk283/tatekaezamurai-bot/server ã§ã‚ã‚‹ã¹ã
```

### Step 2: ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª

```bash
ls -lh dist/data/database.db
```

**ã‚±ãƒ¼ã‚¹A: ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹**
```
-rw-r--r-- 1 sk283 sk283 20K 1æœˆ 25 10:00 dist/data/database.db
```
â†’ æ¨©é™ã®å•é¡Œã‹ã€ãƒ‘ã‚¹ã®å•é¡Œ

**ã‚±ãƒ¼ã‚¹B: ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„**
```
ls: cannot access 'dist/data/database.db': No such file or directory
```
â†’ Step 3ã¸

### Step 3: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ç¢ºèª

```bash
find . -name "database.db" -type f
```

**å‡ºåŠ›ä¾‹**:
```
./dist/data/database.db
./src/data/database.db
```
â†’ ãƒ•ã‚¡ã‚¤ãƒ«ã¯å­˜åœ¨ã™ã‚‹ã€‚ãƒ‘ã‚¹ã®å•é¡Œã€‚

**å‡ºåŠ›ä¾‹ï¼ˆä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„ï¼‰**:
```
ï¼ˆä½•ã‚‚å‡ºåŠ›ã•ã‚Œãªã„ï¼‰
```
â†’ ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã€‚Step 4ã¸

### Step 4: ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ

```bash
# ãƒ“ãƒ«ãƒ‰
npm run build

# ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
pm2 restart all

# ãƒ­ã‚°ã§ç¢ºèª
pm2 logs --lines 20

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆã‚’ç¢ºèª
ls -lh dist/data/database.db
```

### Step 5: çµ¶å¯¾ãƒ‘ã‚¹ã§è©¦ã™

```bash
sqlite3 ~/tatekaezamurai-bot/server/dist/data/database.db
```

ã“ã‚Œã§é–‹ã‘ã‚Œã°ã€ç›¸å¯¾ãƒ‘ã‚¹ï¼ˆã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã®å•é¡Œã§ã™ã€‚

---

## âœ… æ¨å¥¨è§£æ±ºæ–¹æ³•

**æœ€ã‚‚ç¢ºå®Ÿãªæ–¹æ³•**:

```bash
# 1. serverãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd ~/tatekaezamurai-bot/server

# 2. ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
ls -lh dist/data/database.db

# 3. å­˜åœ¨ã—ãªã„å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•
pm2 restart all

# 4. å†åº¦ç¢ºèª
ls -lh dist/data/database.db

# 5. SQLiteã‚’èµ·å‹•
sqlite3 dist/data/database.db
```

---

## ğŸ”§ ã‚ˆãã‚ã‚‹ãƒŸã‚¹

### ãƒŸã‚¹1: ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèªã—ãªã„

```bash
# âŒ é–“é•ã„
sk283@raspberrypi:~ $ sqlite3 dist/data/database.db
Error: unable to open database

# âœ… æ­£ã—ã„
sk283@raspberrypi:~/tatekaezamurai-bot/server $ sqlite3 dist/data/database.db
SQLite version 3.40.1
```

### ãƒŸã‚¹2: çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ã‚ãªã„

```bash
# âœ… ã©ã“ã‹ã‚‰ã§ã‚‚å‹•ã
sqlite3 ~/tatekaezamurai-bot/server/dist/data/database.db
```

### ãƒŸã‚¹3: ã‚¿ãƒ–è£œå®Œã‚’ä½¿ã‚ãªã„

```bash
# ã‚¿ãƒ–è£œå®Œã‚’ä½¿ãˆã°ãƒ‘ã‚¹ãƒŸã‚¹ã‚’é˜²ã’ã‚‹
sqlite3 dist/[TAB]
sqlite3 dist/data/[TAB]
sqlite3 dist/data/database.db
```

---

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

```
â–¡ ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ ~/tatekaezamurai-bot/server ã‹ï¼Ÿ
  â†’ pwd ã§ç¢ºèª

â–¡ dist/data/database.db ãƒ•ã‚¡ã‚¤ãƒ«ã¯å­˜åœ¨ã™ã‚‹ã‹ï¼Ÿ
  â†’ ls -lh dist/data/database.db ã§ç¢ºèª

â–¡ dist/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯å­˜åœ¨ã™ã‚‹ã‹ï¼Ÿ
  â†’ ls -la dist/ ã§ç¢ºèª

â–¡ npm run build ã‚’å®Ÿè¡Œã—ãŸã‹ï¼Ÿ
  â†’ å®Ÿè¡Œã—ã¦ã„ãªã‘ã‚Œã°å®Ÿè¡Œ

â–¡ ã‚µãƒ¼ãƒãƒ¼ã¯èµ·å‹•ã—ã¦ã„ã‚‹ã‹ï¼Ÿ
  â†’ pm2 status ã§ç¢ºèª

â–¡ æ¨©é™ã¯æ­£ã—ã„ã‹ï¼Ÿ
  â†’ ls -l dist/data/database.db ã§ç¢ºèª
```

---

## ğŸ¯ ä»Šã™ãå®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰

**Raspberry Piã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„**:

```bash
cd ~/tatekaezamurai-bot/server && ls -lh dist/data/database.db
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®çµæœã‚’æ•™ãˆã¦ãã ã•ã„ã€‚ãã‚Œã«å¿œã˜ã¦æ¬¡ã®å¯¾å‡¦ã‚’æ¡ˆå†…ã—ã¾ã™ã€‚
